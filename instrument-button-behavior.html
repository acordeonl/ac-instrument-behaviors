<link rel="import" href="../polymer/polymer.html">

<script>
/**
* Behavior that highlights stuff.
*
* @polymerBehavior
*/
    InstrumentButtonBehavior= {
        properties:{
            insrumentOpacity:{
                type:Number,
                value:1
            },
            instrumentEventQueue: {
                type: Array,
                value: []
            },
            instrumentNote: {
                type: String,
                value: ""
            },
            showingInstrumentNotes:{
                type:Boolean,
                value:false
            },
            instrumentState: {
                type: Number,
                value:0
            },
            playbackOpacity:{
                type:Number,
                value:1
            },
            playbackEventQueue: {
                type: Array,
                value: []
            },
            playBackNote: {
                type: String,
                value: ""
            },
            showingPlaybackNotes:{
                type:Boolean,
                value:false
            },
            playbackState: {
                type: Number,
                value:0
            }
        },
        update: function () {
            var next;
            while (this.playbackEventQueue.length > 0) {
                next = this.playbackEventQueue[this.playbackEventQueue.length - 1];
                if (next.detail.time < context.currentTime) {
                    this.playbackState = next.detail.buttonState;
                    this.playbackEventQueue.pop();
                } else {
                    break;
                }
            }
            while (this.instrumentEventQueue.length > 0) {
                next = this.instrumentEventQueue[this.instrumentEventQueue.length - 1];
                if (next.detail.time < context.currentTime) {
                    this.instrumentState = next.detail.buttonState;
                    this.instrumentEventQueue.pop();
                } else {
                    break;
                }
            }
        },
        stop: function(){
            this.playbackEventQueue = [] ;
        },
        addButtonAction: function (e) {
            if (e.detail.origin === 'playback')
                this.playbackEventQueue.unshift(e);
            if (e.detail.origin === 'instrument') {
                this.instrumentEventQueue.unshift(e);
            }
        }
    } ;
</script>
